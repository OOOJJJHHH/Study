ë°˜ë³µë¬¸ ì‘ì„±

# ê²°ì¸¡ì¹˜ í™•ì¸ ë° ì œê±° : inì—°ì‚°ì
```
# ê²°ì¸¡ì¹˜ ì¡´ì¬ì—¬ë¶€ í™•ì¸(NAê°€ ì¡´ì¬í•œë‹¤ë©´ True)
is.na(df)
--
ex)
# í…Œì´ë¸” í˜•íƒœë¡œ falseì™€ trueì˜ ê°œìˆ˜ë¥¼ ì¶œë ¥
# FALSE  TRUE 
# 8     2 
table(is.na(df))
NAëŠ” ìµœì†Ÿê°’ìœ¼ë¡œ ì¸ì‹ëŒ
```

```
# score ì»¬ëŸ¼ì— ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ëŠ” í•´ë‹¹ í–‰ ì¶œë ¥
df %>%
  filter(is.na(score))

# ê²°ì¸¡ì¹˜ê°€ ì¡´ì¬í•˜ëŠ” í–‰ì„ ì œê±°í•˜ê³  ë³€ìˆ˜ì— ë“±ë¡
df1 = df %>% 
  filter(!is.na(score))
```

```
# score, gender ì—´ì— NAê°€ ì•„ë‹Œ ê°’ë§Œ ì„ íƒ
# & â†’ ë‘ ì¡°ê±´ì´ ëª¨ë‘ ì°¸ì¸ í–‰ë§Œ ë‚¨ê¹€
df1 = df %>%
  filter(!is.na(score) & !is.na(gender))
df1

# ìœ„ ì½”ë“œì™€ ê°™ì€ ê¸°ëŠ¥
na.omit(df)
```

```
# ê²°ì¸¡ì¹˜ ì œì™¸í•˜ê³  í•¨ìˆ˜ ì‹¤í–‰ : na.rm = T
mean(df$score, na.rm = T)
```

```
# mathì»¬ëŸ¼ 3,8,15í–‰ì— NAë¡œ ë³€í™˜
exam[c(3,8,15), "math"] = NA

# mathì»¬ëŸ¼ì— NAê°’ ì œì™¸í•˜ê³  í‰ê·  ê³„ì‚° 
exam %>% 
  summarise(mean_math = mean(math, na.rm = T))

# ë§Œì•½ examì˜ mathì»¬ëŸ¼ì— NAê°’ì´ ìˆë‹¤ë©´ í•´ë‹¹ ê°’ì„ 55ë¡œ ì¹˜í™˜í•˜ê³  ì•„ë‹ˆë¼ë©´ ì¦‰ NAê°€ ì•„ë‹ˆë¼ë©´ ê·¸ëŒ€ë¡œ ìœ ì§€
exam$math = ifelse(is.na(exam$math), 55, exam$math)
```


# ì´ìƒì¹˜ í™•ì¸ ë° ì œê±° : ì‚¬ìš©ë˜ëŠ” ì°¨íŠ¸
# + dplyr íŒ¨í‚¤ì§€ ì‚¬ìš©ë²•
```
df <- data.frame(
  íŒ€ = c("A", "A", "B", "B"),
  ê²½ê¸° = c(10, 12, 15, 13),
  íƒ€ìˆ˜ = c(20, 22, 30, 28)
)

# across()ëŠ” ì—¬ëŸ¬ ì—´ì— ê°™ì€ í•¨ìˆ˜ë¥¼ ì ìš©í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ë„êµ¬
# ê²½ê¸°ì™€ íƒ€ìˆ˜ì— mean(í‰ê· )ì„ ì ìš©
df %>%
  group_by(íŒ€) %>%
  summarise(across(c(ê²½ê¸°, íƒ€ìˆ˜), mean))
```

```
# genderì—ëŠ” 1,2ë§Œ ì¡´ì¬í•´ì•¼ í•˜ëŠ”ë° ê·¸ ì™¸ì— ê°’ì´ ìˆì„ë•Œ ê²°ì¸¡ì²˜ë¦¬
out = data.frame(gender = c(1,2,3,1,2,1), score = c(5,4,5,7,3,2))
out
# genderê°€ 3ì´ ë¼ë©´ ì´ìƒì¹˜ì´ê¸° ë•Œë¬¸ì— ì œê±°
out$gender = ifelse(out$gender == 3, NA, out$gender)
# genderê°€ 1,2ê°€ ì•„ë‹ˆë¼ë©´ ì´ìƒì¹˜ì´ê¸° ë•Œë¬¸ì— ë‚˜ë¨¸ì§€ ìˆ˜ëŠ” ì œê±°
out$gender = ifelse(out$gender %in% c(1,2), out$gender, NA)
```

```
library(ggplot2)
mpg
# ë°•ìŠ¤í”Œë¡¯ìœ¼ë¡œ mpgë¥¼ ì¶œë ¥
boxplot(mpg$hwy)
# ë°•ìŠ¤í”Œë¡¯ìœ¼ë¡œ mpgë¥¼ ì¶œë ¥, consoleì°½ì— stats ë‚´ìš© ì¶œë ¥
boxplot(mpg$hwy)$stats
```

```
# Q1. drv(êµ¬ë™ë°©ì‹)ë³„ë¡œ hwy(ê³ ì†ë„ë¡œ ì—°ë¹„)í‰ê· ì´ ì–´ë–»ê²Œ ë‹¤ë¥¸ì§€ ì•Œì•„ë³´ë ¤ê³  í•©ë‹ˆë‹¤. ë¶„ì„ì„ í•˜ê¸° ì „ì— ìš°ì„  ë‘ ë³€ìˆ˜ì— ê²°ì¸¡ì¹˜ê°€ ìˆëŠ”ì§€ í™•ì¸í•´ì•¼ í•©ë‹ˆë‹¤. drvë³€ìˆ˜ì™€ hwyë³€ìˆ˜ì— ê²°ì¸¡ì¹˜ê°€ ëª‡ ê°œ ìˆëŠ”ì§€ ì•Œì•„ë³´ì„¸ìš”
mpg$hwy
table(is.na(mpg$drv))
table(is.na(mpg$hwy))
```

```
# Q2. filter()ë¥¼ ì´ìš©í•´ hwy ë³€ìˆ˜ì˜ ê²°ì¸¡ì¹˜ë¥¼ ì œì™¸í•˜ê³ , ì–´ë–¤ êµ¬ë™ë°©ì‹ì˜ hwy í‰ê· ì´ ë†’ì€ì§€ ì•Œì•„ë³´ì„¸ìš”. í•˜ë‚˜ì˜ dplyrêµ¬ë¶„ìœ¼ë¡œ ë§Œë“¤ì–´ì•¼ í•©ë‹ˆë‹¤
 
mpg %>% 
  filter(!is.na(hwy)) %>% 
  group_by(drv) %>% 
  dplyr::summarise(mean_h = mean(hwy))
```

# ggplot2(barplot)  í™œìš© + ë§‰ëŒ€ê·¸ë˜í”„
```
kor = read.table("í•™ìƒë³„êµ­ì–´ì„±ì _new.txt", header = T, sep = ',')
kor
# ì´ë¦„ì„ xì¶•, ì ìˆ˜ë¥¼ yì¶•ìœ¼ë¡œ í•´ì„œ **ì  ê·¸ë˜í”„(ì‚°ì ë„)**ë¥¼ ê·¸ë¦¼
# ê° í•™ìƒ ì´ë¦„ ìœ„ì— ì  í•˜ë‚˜ì”© ì°í˜
ggplot(kor, aes(x = ì´ë¦„, y = ì ìˆ˜))+geom_point()

# geom_bar() : barplotê³¼ ë¹„ìŠ·í•œ ì—­í• 
# geom_bar(stat = 'identity'): yì¶• ê°’(ì ìˆ˜)ì„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•´ì„œ ë§‰ëŒ€ê·¸ë˜í”„ ìƒì„±
# stat = "identity"ëŠ” ìˆ˜ì¹˜ë¥¼ ì§ì ‘ ë³´ì—¬ì£¼ëŠ” ë°©ì‹ (ê¸°ë³¸ì€ count, ë¹ˆë„ìˆ˜)
# color = 'red': ë§‰ëŒ€ í…Œë‘ë¦¬ ìƒ‰ì„ ë¹¨ê°„ìƒ‰ìœ¼ë¡œ
# size = 5: í…Œë‘ë¦¬ ì„  ë‘ê»˜ë¥¼ 5ë¡œ
# fill = 'green': ë§‰ëŒ€ ë‚´ë¶€ ìƒ‰ì„ ì´ˆë¡ìƒ‰ìœ¼ë¡œ ì±„ì›€
gg1 = ggplot(kor, aes(x = ì´ë¦„, y = ì ìˆ˜))+ geom_bar(stat = 'identity', color = 'red', size = 5, fill = 'green')

# axis.text.xëŠ” **xì¶• ê¸€ì(label)**ë¥¼ ê¾¸ë¯¸ëŠ” ê±°ê³ ,
# element_text()ëŠ” ê¸€ê¼´, ìƒ‰ìƒ, ìœ„ì¹˜ ë“±ì„ ì§€ì •í•˜ëŠ” í•¨ìˆ˜ì˜ˆìš”.
# angle = 45: xì¶• ê¸€ìë¥¼ 45ë„ ê¸°ìš¸ì„ (ê¸€ì ê²¹ì¹¨ ë°©ì§€)
# hjust, vjust: ê¸€ìì˜ ìˆ˜í‰Â·ìˆ˜ì§ ìœ„ì¹˜ ì¡°ì •
gg1 + theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, colour = 'blue', size = 8))
```

```
# kem ë°ì´í„°í”„ë ˆì„ì„ ì´ë¦„ ìˆœìœ¼ë¡œ ì •ë ¬í•˜ê³  â†’ ê³¼ëª© ìˆœìœ¼ë¡œ ì •ë ¬
skem = arrange(kem, ì´ë¦„, ê³¼ëª©)

# í•™ìƒ(ì´ë¦„)ë³„ë¡œ ì ìˆ˜ë¥¼ ëˆ„ì í•´ì„œ ë”í•œ ê°’ì„ ëˆ„ì í•©ê³„ ì—´ë¡œ ì¶”ê°€
skem2 = ddply(skem,'ì´ë¦„', transform, ëˆ„ì í•©ê³„ = cumsum(ì ìˆ˜))

# label: ë§‰ëŒ€ ì•ˆìª½ì— í…ìŠ¤íŠ¸ë¥¼ ë„£ì„ ìœ„ì¹˜ ê³„ì‚°
# ê³„ì‚° ë°©ì‹: ëˆ„ì í•©ê³„ì˜ ì¤‘ì•™ì¯¤
# ğŸ‘‰ ì ìˆ˜ì˜ ì ˆë°˜ì„ ë¹¼ì„œ ë§‰ëŒ€ì˜ ì¤‘ê°„ ìœ„ì¹˜ì— í…ìŠ¤íŠ¸ê°€ ë“¤ì–´ê°€ê²Œ í•¨
skem3 = ddply(skem2,'ì´ë¦„', transform, ëˆ„ì í•©ê³„ = cumsum(ì ìˆ˜), label = cumsum(ì ìˆ˜) - 0.5 * ì ìˆ˜)

# geom_bar(stat = "identity"): ì‹¤ì œ ì ìˆ˜ ì‚¬ìš©í•´ì„œ ë§‰ëŒ€ ë†’ì´ ê²°ì •
#
# position_stack(reverse = TRUE):
#     ëˆ„ì  ë§‰ëŒ€ ìŒ“ëŠ” ìˆœì„œ ìœ„ì—ì„œ ì•„ë˜ë¡œ ë’¤ì§‘ìŒ
#     ë²”ë¡€(legend)ë„ ì•„ë˜ìª½ë¶€í„° ìˆœì„œëŒ€ë¡œ ë‚˜ì˜¤ë„ë¡ guide_legend(reverse = TRUE)
# geom_text():
#     ë§‰ëŒ€ ë‚´ë¶€ì— "ì ìˆ˜ ì " í˜•íƒœì˜ í…ìŠ¤íŠ¸ í‘œì‹œ
#     ìœ„ì¹˜ëŠ” label ê°’ìœ¼ë¡œ ì •í•œ ì¤‘ì•™
gg2 = ggplot(skem3, aes(x = ì´ë¦„, y = ì ìˆ˜, fill = ê³¼ëª©)) + geom_bar(stat = 'identity', position = position_stack(reverse = T)) + geom_text(aes(y = label, label = paste(ì ìˆ˜,'ì ')), color = 'black', size = 4) + guides(fill = guide_legend(reverse = T))

# xì¶•(ì´ë¦„) ê¸€ìë¥¼ 45ë„ ê¸°ìš¸ì´ê³ 
# ê¸€ì ìœ„ì¹˜(hjust, vjust) ë° ìƒ‰ìƒ, í¬ê¸° ì§€ì •
gg2 + theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1, color = 'black', size = 8))
```

```
# geom_segment(): (mpg, disp) â†’ (mpg, 0)ê¹Œì§€ ì„¸ë¡œì„ 
# geom_point(): ì  ìœ„ì¹˜ (mpg, disp)
# color = gear: ê¸°ì–´ ìˆ˜(3, 4, 5)ì— ë”°ë¼ ìƒ‰ êµ¬ë¶„
# scale_color_continuous(...): ìƒ‰ì„ ì—°ì†ì ìœ¼ë¡œ í‘œí˜„
# theme_minimal(): ë°°ê²½ ë¯¸ë‹ˆë©€ ìŠ¤íƒ€ì¼

gg1 = ggplot(mt, aes(x = mpg, y = disp))

gg1 + 
  geom_segment(aes(xend = mpg, yend = 0, color = gear), size = 1.3) +
  geom_point(aes(color = gear), size = 6) +
  scale_color_continuous(type = "gradient") +
  theme_minimal()
```

```
# (mpg, disp) â†’ (0, disp)ë¡œ ê°€ë¡œì„ 
# xend = 0: ì‹œì‘ì ì´ xì¶• (0)
# viridis: ì‹œê°ì ìœ¼ë¡œ êµ¬ë¶„ ì˜ ë˜ëŠ” ìƒ‰ìƒ íŒ”ë ˆíŠ¸

gg1 + 
  geom_segment(aes(xend = 0, yend = disp, color = gear), size = 1.3) +
  geom_point(aes(color = gear), size = 6) +
  scale_color_continuous(type = "viridis") +
  theme_minimal()
```

```
# geom_point()	ì ë§Œ ê·¸ë¦¬ê¸°
# geom_point(color = 'blue')	ëª¨ë“  ì ì„ íŒŒë€ìƒ‰ìœ¼ë¡œ
# aes(color = factor(am))	ìë™/ìˆ˜ë™ ì—¬ë¶€(am)ì— ë”°ë¼ ìƒ‰ ë‹¤ë¥´ê²Œ
# aes(size = wt)	ì°¨ ë¬´ê²Œ(wt)ì— ë”°ë¼ ì  í¬ê¸° ë‹¤ë¥´ê²Œ
# aes(shape = factor(am))	ì  ëª¨ì–‘ ë‹¤ë¥´ê²Œ
# scale_color_manual()	ìƒ‰ìƒì„ ì§ì ‘ ì§€ì • (red, green)
# geom_line()	ì„ ë„ ê°™ì´ ê·¸ë¦¼
# labs()	ì¶• ì´ë¦„ í•œê¸€ë¡œ ì„¤ì •

g1 = ggplot(mt, aes(x = hp, y = mpg))
```

```

# arrange(): ì´ë¦„, ê³¼ëª©ìˆœ ì •ë ¬
# group = ì´ë¦„: ì´ë¦„ë³„ë¡œ ì„ ì„ ê·¸ë¦¬ê¸° ìœ„í•œ ì—°ê²° ê·¸ë£¹ ì„¤ì •
# color = ì´ë¦„: ì´ë¦„ë³„ë¡œ ì„ ê³¼ ì  ìƒ‰ ë‹¤ë¥´ê²Œ
# geom_line(): ì„  ê·¸ë˜í”„ (ì ìˆ˜ë¥¼ ì„ ìœ¼ë¡œ ì—°ê²°)
# geom_point(): ì  ì¶”ê°€ (í¬ê¸°: 6, ëª¨ì–‘: 19 = ê½‰ ì°¬ ì›)

th = read.csv("í•™ìƒë³„ê³¼ëª©ë³„ì„±ì _3ê¸°_3ëª….csv")
ss = arrange(th, ì´ë¦„, ê³¼ëª©)

ggplot(ss, aes(x = ê³¼ëª©, y = ì ìˆ˜, group = ì´ë¦„, color = ì´ë¦„)) +
  geom_line() +
  geom_point(size = 6, shape = 19)
```

# ê¸°ëŠ¥ ì„¸ë¶€ ì„¤ëª…
```
is.na() # í…Œì´ë¸” ì´ë¦„ -> í…Œì´ë¸” ì „ì²´ì˜ ë‚´ìš©ì„ ê²°ì¸¡ì¹˜ì—ë”°ë¼ true/falseê°’ìœ¼ë¡œ ì¹˜í™˜í•´ì„œ ë³´ì—¬ì¤Œ
table(is.na()) # í…Œì´ë¸” ì´ë¦„ -> í…Œì´ë¸” ë‚´ë¶€ì— NA ê°’ì´ ëª‡ê°œì¸ì§€ ê°œìˆ˜ë¥¼ ë³´ì—¬ì¤Œ

filter() # ì¡°ê±´ -> ë‚´ë¶€ì— ì¡°ê±´ì„ ë„£ìœ¼ë©´ í•´ë‹¹ ì¡°ê±´ì— ë§ëŠ” ë‚´ìš©ë“¤ë§Œ ë°˜í™˜

í…Œì´ë¸”ì˜ íŠ¹ì • ê°’, í–‰/ì—´ì„ NAë¡œ ë³€í™˜í•˜ëŠ” ë°©ë²•
ex) exam[c(3,8,15), "math"] = NA

ifelse() # ì¡°ê±´, ì°¸ì¼ë•Œ, ê±°ì§“ì¼ë•Œ -> í•´ë‹¹ ì¡°ê±´ì— ë§ìœ¼ë©´ ì°¸ì¼ë•Œ ê°’ì„ ë°˜í™˜, ì•„ë‹ˆë¼ë©´ ê±°ì§“ì¼ë•Œ ê°’ ë°˜í™˜
ì‚¬ìš©ì˜ˆì‹œ
ex) exam$math = ifelse(is.na(exam$math) , 55, exam$math)

summarise() # ìƒˆ ì»¬ëŸ¼ ì´ë¦„ = ìš”ì•½í•  ê³„ì‚°ì‹ -> ìš”ì•½ëœ ê²°ê³¼ í‘œì¶œ
ì‚¬ìš©ì˜ˆì‹œ
ex) summarise(mean_math = mean(math, na.rm = T))
ex) dplyr::summarise(across(c(ê²½ê¸°, íƒ€ìˆ˜), mean))
ex) dplyr::summarise(mean_math = cumsum(math))

arrange() # ì •ë ¬í•œ í…Œì´ë¸”ì˜ ì»¬ëŸ¼ëª… -> ê¸°ë³¸ìœ¼ë¡œ ì˜¤ë¦„ì°¨ìˆœìœ¼ë¡œ ì •ë ¬
ì‚¬ìš©ì˜ˆì‹œ
ex) arrange(íŒ€, desc(íƒ€ìˆ˜))

mutate() # ìƒˆë¡­ê²Œ ë§Œë“¤ ì»¬ëŸ¼ëª… = (ë³€í˜•í•´ì„œ ì¶”ê°€í•  ê°’)
ì‚¬ìš©ì˜ˆì‹œ
ex) mutate(íŒ€ë³„_í‰ê·  = mean(ì ìˆ˜))

mean() # í…Œì´ë¸”ì˜ íŠ¹ì • ì»¬ëŸ¼ëª… ì§€ì • ex) df$score -> í•´ë‹¹ ì»¬ëŸ¼ì— í‰ê· ì„ ë°˜í™˜
â€» na.rm = T -> naë¥¼ ì§€ì›Œì¤Œ mean() ë‚´ë¶€ì— ë„£ì–´ì„œ ì‚¬ìš© ê°€ëŠ¥
ì‚¬ìš©ì˜ˆì‹œ
ex) mean(math, na.rm = T)

cumsum() # í…Œì´ë¸”ì˜ íŠ¹ì • ì»¬ëŸ¼ -> í•´ë‹¹ ì»¬ëŸ¼ì˜ ëˆ„ì í•©ê³„ë¥¼ êµ¬í•´ì¤Œ
ex) label = cumsum(ì ìˆ˜) - 0.5 * ì ìˆ˜

across() # íŠ¹ì • ì»¬ëŸ¼ëª… -> ì—¬ëŸ¬ ì»¬ëŸ¼ì— ë™ì¼í•œ í•¨ìˆ˜ ì ìš© 
ì‚¬ìš©ì˜ˆì‹œ
ex) across(c(ê²½ê¸°, íƒ€ìˆ˜), mean)


ggplot() #ì‹œê°í™”ì˜ í‹€ì„ ë§Œë“œëŠ” í•¨ìˆ˜
â€» aes()ë¥¼ í†µí•´ x, y, fill ë“±ì˜ ì†ì„±ì„ ì„¤ì • ê°€ëŠ¥
ì‚¬ìš©ì˜ˆì‹œ
ex) ggplot(skem3, aes(x = ì´ë¦„, y = ì ìˆ˜, fill = ê³¼ëª©))

geom_bar() # ì‹¤ì œ yê°’ì„ ê¸°ì¤€ìœ¼ë¡œ ë§‰ëŒ€ê·¸ë˜í”„ë¥¼ ê·¸ë¦¼
ì‚¬ìš©ì˜ˆì‹œ
ex) geom_bar(stat = "identity")

geom_text() # ë§‰ëŒ€ ìœ„ì— í…ìŠ¤íŠ¸(ì˜ˆ: ì ìˆ˜ + "ì ") í‘œì‹œ
ì‚¬ìš©ì˜ˆì‹œ
ex) geom_text(aes(y = label, label = paste(ì ìˆ˜, "ì ")))

theme() # ê·¸ë˜í”„ì˜ ì „ë°˜ì ì¸ ìŠ¤íƒ€ì¼ê³¼ ê¸€ì, ë°°ê²½, ì¶• ë“± ìš”ì†Œì˜ ì™¸í˜•ì„ ì„¤ì •
ì‚¬ìš©ì˜ˆì‹œ
ex) theme(axis.text.x = element_text(angle = 45, hjust = 1, vjust = 1))

guides()
ì‚¬ìš©ì˜ˆì‹œ
ex) guides(fill = guide_legend(reverse = T))

```
